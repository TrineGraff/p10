\section{LARS}
Herefter anvendes LARS algoritmen uden og med lasso modifikationen, hvortil vi anvender \Rlang-pakken \texttt{lars}.
\Rlang-koden for dette afsnit er givet i ---.

For LARS algoritmen uden lasso modifikationen tilføjes en variabel i hvert step og dermed udfører algoritmen 126 steps.
LARS algoritmen med lasso modifikationen udfører 192 steps, hvor variabler kan tilføjes og fjernes igen.

\subsection{Krydsvalidering}
For at finde den optimale model udføres krydsvalidering.
For LARS algoritmen uden lasso modifikationen betragtes antallet af steps, som betegnes \(s\). 
Igen finder vi $\widehat{s}_{\min}$, som angiver den mindste gennemsnitlige krydsvalideringsfejl og $\widehat{s}_{\text{1sd}}$ som betegner den mindste værdi således at fejlen er indenfor en standard afvigelse. 

For LARS algoritmen med lasso modifikationen betragtes en såkaldt fraction af \(\ell_1\)-norm, der er givet ved \(\frac{\vert \tbeta \vert}{\max \vert \tbeta \vert}\).
Vi betragter en følge af 100 værdier af fraction af \(\ell_1\)-norm mellem 0 og 1, hvorudfra vi finder $\widehat{f}$.
Igen betragtes \(\widehat{f}_{\min}\) og \(\widehat{f}_{\text{1sd}}\).


%Vi finder $\widehat{s}$, som betegner antallet af steps, ved krydsvalidering, men igen ser vi ikke kun på  $\widehat{s}_{\min}$, som giver den mindste gennemsnitlige krydsvaliderings fejl, men også den mindste værdi således at fejlen er indenfor en standard afvigelse, som betegnes $\widehat{s}_{\text{1sd}}$. 
%Krydsvalideringen for lasso deler L1-normen op i en følge af 100 punkter mellem 0 og 1, hvor vi herefter finder $\widehat{f}$. Vi ser ikke kun på den model der giver den mindste krydsvaliderings fejl, som betegnes  $\widehat{f}_{\min}$, men også  $\widehat{f}_{\text{1sd}}$ . 

Figur \ref{fig:lars_kryds} viser krydsvalideringskurven og standardfejl som funktion af steps for LARS algoritmen og som funktion af fraction af \(\ell_1\)-norm for LARS algoritmen med lasso modifikationen. 
\imgfigh{lars_kryds.pdf}{1}{10-fold krydsvalideringsfejl som funktion af steps for LARS algoritmen og som funktion af fraction af \(\ell_1\)-norm for LARS algoritmen med lasso modifikationen. De stiplede linjer indikerer værdier af henholdsvis \(s\) og \(f\) med den mindste krydsvalideringsfejl og den mindste værdi af \(s\) og \(f\) således at fejlen er indenfor en standard afvigelse af minimum.}{lars_kryds}
%
Tabel \ref{tab:lars_lasso_tab} giver antallet af steps, gennemsnitlige krydsvalideringsfejl og antallet af variable for LARS algoritmen for \(s_\text{min}\) og \(s_{1 \text{sd}}\) og fraction af \(\ell_1\)-norm, gennemsnitlige krydsvalideringsfejl og antallet af variable for LARS algoritmen med lasso modifikationen for \(f_\text{min}\) og \(f_{1 \text{sd}}\).
Krydsvalideringen fejlen afviger først på 5. decimal, derfor vælger vi modellerne med det mindste antal variable. ---
%
\input{fig/tab/lars_lasso_tab}
%
På figur \ref{fig:coef_lars_kryds} vises koefficienter for de valgte variable for LARS uden og med lasso modifikation.
\imgfigh{coef_lars_kryds.pdf}{1}{Estimerede koefficienter for LARS algoritmen uden og med lasso modifikationen.
Farverne indikerer hvilken gruppe, variablerne tilhører.}{coef_lars_kryds}
%

\newpage
\subsection{Inferens}
Lars algoritmen udfører 126 steps, hvor én variabel tilføjes i hvert step.
Funktionen \texttt{larInf} fra \Rlang-pakken \texttt{selectiveInference} udregner \(p\)-værdier og konfidensintervaller for LARS algoritmen.
I tabel \ref{tab:larInf} vises resultaterne.
%
\input{fig/tab/larInf}
%
Heraf ses at nulhypotesen primært afvises for variabler i gruppe 2 (\textcolor{blue3}{HWIURATIO}, \textcolor{blue3}{UEMP15OV}, \textcolor{blue3}{UEMPLT5}, \textcolor{blue3}{UEMP5TO14}, \textcolor{blue3}{CLF16OV}) samt en variabel fra gruppe 6 (\textcolor{orange}{EXUSUKx}).

Ifølge spacing testen afvises kun variabler fra gruppe 2, dog kan vi ikke afvise nulhypotesen for variablerne \textcolor{blue3}{PAYEMS} og \textcolor{blue3}{CLAIMSx}.

Ifølge kovarianstesten er alle variable tilhørende gruppe 2 signifikant med undtagelse af \textcolor{blue3}{PAYEMS}, \textcolor{blue3}{lag 1} og \textcolor{blue3}{CLAIMSx}, hvor nulhypotesen ikke kan afvises.
Derudover ser vi, at også variablerne \textcolor{chartreuse4}{INDPRO}, \textcolor{orange}{GS1} og \textcolor{orange}{GS5} afviser nulhypotesen.

Men kun variablerne \textcolor{blue3}{HWIURATIO}, \textcolor{blue3}{UEMP15OV}, \textcolor{blue3}{UEMPLT5}, \textcolor{blue3}{UEMP5TO14}, \textcolor{blue3}{CLF16OV} afvises for alle teste, hvorfra vi konkluderer at disse er signifikante.
\newpage
\subsubsection{Kovarians test}
Som nævnt udfører LARS algoritmen med lasso modifikationen 192 steps, hvori variablerne tilføjes og nogle fjernes igen.
For \(\widehat{f}_{1\text{sd}}=0.2424\) finder vi 13 prædiktorer, hvorpå kovarians testen udføres.
Funktionen \texttt{covTest} fra \Rlang-pakken af samme navn udregner teststørrelsen samt \(p\)-værdie for kovarianstesten for LARS algoritmen med lasso modifikation.
Tabel \ref{tab:covTest} viser resultatet af dette.
For 6 ud af 9 prædiktorer som tilhører gruppe 2 med undtagelse af \textcolor{blue3}{PAYEMS}, \textcolor{blue3}{lag 1} og \textcolor{blue3}{USCONS} afvises nulhypotesen, hvilket betyder, at??
For de resterende variable kan vi ikke afvise nulhypotesen.
%
\input{fig/tab/covTest}
%
For de valgte variable udfører algoritmen 23 steps, hvor variablerne  \textcolor{chartreuse4}{CUMFNS}, \textcolor{blue3}{MANEMP}, \textcolor{orange}{TB6MS}, \textcolor{orange}{GS1}, \textcolor{blue3}{USGOOD} tilføjes og fjernes igen.




%#  Function produces one fit at each new variable entry.
%# Cross-Validation for LASSO chops up the L1-norm into sequence of 100 points. 
%#  SE for CV is found from the sample SE of the squared errors.  NOT from rerunning CV multiple times.
%# Therefore CV may be inappropriate for small n.  Use Cp from Ssummary() instead.
%
